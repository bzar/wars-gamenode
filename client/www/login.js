// Generated by CoffeeScript 1.4.0
(function() {

  require(["gamenode"], function() {
    var client, next, session;
    $("#username").prop("disabled", true);
    $("#password").prop("disabled", true);
    $("#remember").prop("disabled", true);
    $("#loginButton").prop("disabled", true);
    client = new GameNodeClient();
    session = new Session(client);
    next = /[?&]next=(.*)/.exec(window.location.search);
    if (next !== null) {
      next = next[1];
    } else {
      next = "mygames.html";
    }
    session.onAuthenticationSuccess = function() {
      return location.replace(next);
    };
    client.onConnected = function() {
      $("#username").prop("disabled", false);
      $("#username").focus();
      $("#password").prop("disabled", false);
      $("#remember").prop("disabled", false);
      $("#loginButton").prop("disabled", false);
      return session.authenticate();
    };
    return $(document).ready(function() {
      $("#loginForm").submit(function(e) {
        var password, remember, username;
        e.preventDefault();
        session.onAuthenticationFailure = function() {
          return alert("Invalid username/password!");
        };
        username = $("#username").val();
        password = $("#password").val();
        remember = $("#remember").prop("checked");
        return session.authenticate(username, password, remember);
      });
      return client.connect(WARS_CLIENT_SETTINGS.gameServer);
    });
  });

}).call(this);
